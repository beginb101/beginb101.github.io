---
layout: post
title: MySQL SQL 응용 용어
description: >
  2022-10-06-MySQL SQL 응용 용어
hide_description: false
category: dailydev
---

- Table of Contents
{:toc}

## 선택도
선택도(selectivity)란 테이블의 특정 열을 기준으로 해당 열의 조건절(WHERE절 조건문)에 따라 선택되는 데이터 비율을 의미한다. 만약 해당 열에 중복되는 데이터가 많다면 __선택도가 높다__ 고 평가할 수 있으며 실제로 조건절에 따라 대량의 데이터가 선택된다. 해당열에 중복되는 데이터가 적다면 __선택도가 낮다__ 고 평가할 수 있으며 조건절에 따라 매우 적은양의 데이터가 선택된다. 즉 낮은 선택도가 원하는 데이터만 골라내는 능력이다. 따라서 낮은 선택도를 가지는 열은 데이터를 조회하는 SQL문에서 인덱스열을 생성할 때 주요 고려대상이다.

## 선택도 계산 수식
- 선택도 = 선택한 데이터 건수 / 전체 데이터 건수

선택하는 조건절의 데이터 건수를 매번 계산할 수 없고 데이터의 삭제와 수정, 삽입이 수시로 발생하는 만큼 중복이 제거된 데이터의 건수를 활용하여 선택도를 일반화한다.

- 변형된 선택도 = 1 / DISTINCT (COUNT 열명)

## 카디널리티
카디널리티(cardinality)의 사전적 정의는 '하나의 데이터 유형으로 정의되는 데이터 행의 개수'이다. 여기서는 전체 데이터에 접근한 뒤 출력될 것이라 예상되는 데이터 건수를 가리킨다. 현업에서는 전체 행에 대한 특정 열의 중복 수치를 나타내는 지표로 활용된다.

- 카디널리티 = 전체 데이터 건수 x 선택도

MySQL에서는 중복을 제외한 유일한 데이터값의 수로 계산한다.
따라서 중복도가 높으면 카디널리티가 낮고 중복도가 낮으면 카디널리티가 높다고 정리할 수 있다.

## 힌트
말그대로 데이터를 찾을 때 데이터베이스에게 힌트를 전달함으로써 빠르게 찾을 수 있게 하는 것이다.
먼저 학생 테이블의 이름열에 대한 학생_IDX01인덱스와 전공코드 열에 대한 학생_IDX02 인덱스가 있을 때 인덱스의 각 행이 테이블의 기본키 값을 가리킨다고 할때 다음과 같이 쿼리를 작성할 수 있다. 

```sql
SELECT 학번, 전공코드
  FROM 학생
 WHERE 이름 = '유재석';
```
위와 같은 쿼리가 있을때 학생_IDX01인덱스를 활용하라는 힌트를 쿼리에 직접 작성할 수 있다.

```sql
SELECT 학번, 전공코드
  FROM 학생 /*! USE INDEX (학생_IDX01) */
 WHERE 이름 = '유재석';
```
첫 번째로 위와 같이 주석처럼 힌트를 명시하는 방법이다.
```sql
SELECT 학번, 전공코드
  FROM 학생 USE INDEX (학생_IDX01) 
 WHERE 이름 = '유재석';
```
두 번째는 위와 같이 쿼리의 일부로 작성하는 방법이다.<br>

MySQL과 MariaDB에서 실무에 자주 쓰이는 힌트 목록

| 힌트 | 설명  | 활용도 |  
|:--- | :--- | :--- | 
| STRAIGHT_JOIN | FROM 절에 작성된 테이블 순으로 조인을 유도하는 힌트 | 높음 |
| USE INDEX | 특정 인덱스를 사용하도록 유도하는 힌트 | 높음 |
| FORCE INDEX | 특정 인덱스를 사용하도록 강하게 유도하는 힌트 | 낮음 |
| IGNORE INDEX | 특정 인덱스를 사용하지 못하도록 유도하는 힌트 | 중간 |

## 참고 문헌

[업무에 바로 쓰는 SQL 튜닝](http://www.yes24.com/Product/Goods/102382080)